%% Include packages.
\usepackage[top=0.95in,bottom=1in,left=0.85in,right=0.85in]{geometry}
\usepackage[english]{babel}                             % Advanced language support
\usepackage{amsthm}                                     % Theorem and proof environments

%% Use XCharter for text, Source Code Pro for monospace, Lato for sans-serif, and XCharter-Math for math.
\usepackage{ifluatex}\ifluatex                          % If using lualatex, use fontspec to set the fonts
    \usepackage[no-math]{fontspec}
    \setmainfont{XCharter}
    \setmonofont{Source Code Pro}[Scale=0.94]
    \setsansfont{Lato}[Scale=0.97]
    \usepackage{unicode-math}
    \setmathfont{XCharter-Math.otf}[CharacterVariant={11,12}]
    \setmathfont{XCharter-Math}[range={cal,bfcal},StylisticSet=1]
    \renewcommand{\vec}{\symbfit}                       % Display all vectors created using `\vec` with bold italics
    \newcommand{\mat}{\symbf}                           % Display all matrices created using `\mat` with bold upright
\else                                                   % If using pdflatex (or others), use traditional packages
    \usepackage{mathtools}                              % Math tools (amsmath extension)
    \usepackage{amssymb}                                % Additional math symbols
    \usepackage{XCharter}
    \usepackage[type1,ttdefault,scaled=0.94]{sourcecodepro}
    \usepackage[type1,defaultsans,scaled=0.97]{lato}
    \usepackage[xcharter,scaled=1.05]{newtxmath}        % Resize math fonts to (roughly) match LuaLaTeX setup
    \renewcommand{\vec}{\boldsymbol}                    % Display all vectors created using `\vec` with bold italics
    \newcommand{\mat}{\mathbf}                          % Display all matrices created using `\mat` with bold upright
    \let\emptyset\varnothing                            % Use different empty set symbol to match LuaLaTeX setup
\fi

% %% Option to use sans serif fonts throughout the document (uncomment to enable).
% \renewcommand{\familydefault}{\sfdefault}

%% Additional packages.
\usepackage{fancyhdr}                                   % Fancy headers and footers
\usepackage{csquotes}                                   % Advanced inline and display quotations (recommended with babel)
\usepackage{graphicx}                                   % Displaying images and figures
\usepackage{caption}                                    % Caption typesetting
\usepackage[font=sf]{floatrow}                          % Floating object environments (sans fonts)
\usepackage{subcaption}                                 % Subcaption typesetting
\usepackage[titles]{tocloft}                            % Advanced control over table of contents
\usepackage{parskip}                                    % Paragraph indentation settings
\usepackage[exponent-product=\cdot]{siunitx}            % SI units (cdot instead of cross for exponent product)
\usepackage{enumitem}                                   % Control over enumerate, itemize, and description environments
\usepackage{listings}                                   % `lstlisting` environment for code
\usepackage{lstautogobble}                              % Autogobble for listings
\usepackage[sf,bf]{titlesec}                            % Title section formatting
\usepackage[titletoc]{appendix}                         % Appendices
\usepackage{xcolor}                                     % Various colour settings
\usepackage{anyfontsize}                                % Font size settings (font size substitutions)
\usepackage[most]{tcolorbox}                            % Coloured and framed box environments
\usepackage[showdow,en-US]{datetime2}                   % Date and time settings
\usepackage{multicol}                                   % Multicolumn environment
\usepackage{chemformula}                                % Typeset chemical equations

%% Bibliography settings (build with lualatex -> biber -> lualatex x 2).
\usepackage[style=authoryear,
    maxbibnames=5,
    maxcitenames=2,
    giveninits=true,
    uniquelist=false,
    uniquename=init,
    seconds=true,
    urldate=iso,
]{biblatex}
\addbibresource{references.bib}
\newcommand\citep{\parencite}

%% Increase linespread.
\linespread{1.04}

%% Caption formatting.
\captionsetup{font=sf,labelfont=bf,justification=centering,width=0.9\textwidth}

%% Path to graphics folder.
\graphicspath{{./figures}}

%% Commands for gradient, divergence, and curl operators.
\DeclareMathOperator{\Grad}{grad}
\DeclareMathOperator{\Div}{div}
\DeclareMathOperator{\Curl}{curl}

%% Commands for Big-Oh notation.
\newcommand{\oh}{\mathcal{O}}

%% Commands for the set of real numbers and Lagrangian/Laplace.
\newcommand{\R}{\mathbb{R}}
\newcommand{\La}{\mathscr{L}}

%% Commands for differentials.
\newcommand{\df}{\mathop{}\!\mathrm{d}}

%% Command for transpose.
\newcommand{\T}{\mathrm{T}}

%% Shrink bullet points.
\renewcommand\labelitemi{$\vcenter{\hbox{\tiny$\bullet$}}$}

% %% Numbering within sections (uncomment to enable).
% \numberwithin{equation}{section}
% \numberwithin{table}{section}
% \numberwithin{figure}{section}

%% Fancy page style.
\fancypagestyle{fancy}{
    \fancyhf{}
    \fancyhead[EC]{\sffamily\nouppercase\leftmark}
    \fancyhead[OC]{\sffamily\nouppercase\rightmark}
    \fancyfoot[LE,RO]{\hfill{\sffamily\thepage}\hfill}
    \renewcommand{\headrulewidth}{1pt}
    \renewcommand{\footrulewidth}{0pt}
    \renewcommand{\headrule}{\hbox to\headwidth{\leaders\hrule height \headrulewidth\hfill}}
}

%% Plain page style.
\fancypagestyle{plain}{
    \fancyhf{}
    \cfoot{\sffamily\thepage}
    \renewcommand{\headrulewidth}{0pt}
    \renewcommand{\footrulewidth}{0pt}
}

%% Adjust header height to avoid warnings from fancyhdr.
\setlength{\headheight}{20.39996pt}
\addtolength{\topmargin}{-8.39996pt}

%% Print current font command for debugging font issues.
\makeatletter
\newcommand{\printcurrentfont}{
    \begingroup\escapechar=\m@ne
    \expandafter\expandafter\expandafter\split@name\expandafter\string\the\font\@nil
    \begin{tabular}{ll}
        Encoding: & \f@encoding             \\
        Family:   & \f@family               \\
        Series:   & \f@series               \\
        Shape:    & \f@shape                \\
        Size:     & \f@size                 \\
        Example:  & {\the\font abc ABC 123} \\
        External: & \fontname\font          \\
        TF0:      & \fontname\textfont0
    \end{tabular}
    \endgroup
}
\makeatother

%% Input colours and environments.
\input{tex/colours-and-environments.tex}

%% Always (re)define tudelft-cyaan (used in hyperlinks by default).
\definecolor{tudelft-cyaan}{RGB}{0,166,214}

%% Hyperref setup (option between coloured links and hidelinks).
% \usepackage[hidelinks]{hyperref}
\usepackage[colorlinks,allcolors=tudelft-cyaan]{hyperref}

%% Command for cleveref package. Should be below hyperref.
\usepackage{cleveref}
\crefname{table}{Table}{Tables}
\crefname{section}{Section}{Sections}
\crefname{subsection}{Subsection}{Subsections}
\crefname{figure}{Figure}{Figures}
\crefname{equation}{equation}{equations}